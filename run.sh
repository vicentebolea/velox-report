#!/bin/bash

ALPHA=(0.01)
#MIN_BLOCK_SIZE=(16777216 33554432 67108864 100663296 134217728 167772160 201326592 234881024 268435456)
#MIN_BLOCK_SIZE=(167772160 201326592 234881024 268435456 167772160 201326592 234881024 268435456 167772160 201326592 234881024 268435456)
#MIN_BLOCK_SIZE=(167772160 201326592 234881024 268435456)
MIN_BLOCK_SIZE=(167772161) 
LEAN_INPUT_SPLIT=(0 0.10 0.20 0.30 0.40 0.50 0.60 0.70 0.80 0.90 1) 

set -x
for i in ${ALPHA[*]}; do
  for i in ${MIN_BLOCK_SIZE[*]}; do
    for i in ${LEAN_INPUT_SPLIT[*]}; do
      APPMANAGERFILE=`cat ./experiment-runner.in`
      APPMANAGERFILE=$(sed "s/@ALPHA@/$i/g" <<<"$APPMANAGERFILE")
      APPMANAGERFILE=$(sed "s/@MIN_BLOCK_SIZE@/$i/g" <<<"$APPMANAGERFILE")
      APPMANAGERFILE=$(sed "s/@LEAN_INPUT_SPLIT@/$i/g" <<<"$APPMANAGERFILE")
      echo "$APPMANAGERFILE"
      ssh raven 'bash -s' <<<"$APPMANAGERFILE" 
      sleep 10
      sh log-data.sh
      sleep 3
    done
  done
done
set -x
